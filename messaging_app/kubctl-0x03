#!/bin/bash

echo "Applying updated blue deployment (rolling update)..."
kubectl apply -f blue_deployment.yaml

echo "Monitoring rollout status..."
kubectl rollout status deployment/django-messaging-blue

echo "Testing application availability during rollout..."
for i in {1..10}; do
  curl -s http://localhost:8000 || echo "Request failed"
  sleep 2
done

echo "Verifying pods after rolling update..."
kubectl get pods

echo "Rolling update completed."

